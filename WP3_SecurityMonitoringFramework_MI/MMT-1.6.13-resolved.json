{
  "openapi": "3.0.0",
  "info": {
    "title": "MMT APIs",
    "description": "The APIs describe the data structure of statistical reports generated by MMT-Probe. The APIs allow MMT-Operator, which is a visualization Web application, to collect and aggregate meta data and reports provided by MMT-Probe, and present them via a graphical user interface (e.g., alarms, line charts).",
    "license": {
      "name": "Montimage",
      "url": "https://montimage.com/"
    },
    "version": "1.6.13"
  },
  "servers": [
    {
      "url": "http://localhost:8080",
      "description": "MMT data structures"
    }
  ],
  "paths": {
    "/api/data_mac_real/agggregate": {
      "post": {
        "tags": [
          "api, link"
        ],
        "summary": "Report statistics of the last 5 minutes",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/MacReport"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Invalid input"
          }
        }
      }
    },
    "/api/data_total_real/agggregate": {
      "post": {
        "tags": [
          "api, link"
        ],
        "summary": "Report current statistics",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TotalReport"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Invalid input"
          }
        }
      }
    },
    "/api/data_protocol_real/agggregate": {
      "post": {
        "tags": [
          "api, link"
        ],
        "summary": "Report statistics for detected application and protocols",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ProtocolReport"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Invalid input"
          }
        }
      }
    },
    "/api/data_ip_real/agggregate": {
      "post": {
        "tags": [
          "api, network"
        ],
        "summary": "Report statistics of an IP address",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/IpReport"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Invalid input"
          }
        }
      }
    },
    "/api/data_location_real/agggregate": {
      "post": {
        "tags": [
          "api, network"
        ],
        "summary": "Report statistics of a location",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/LocationReport"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Invalid input"
          }
        }
      }
    },
    "/api/data_link_real/agggregate": {
      "post": {
        "tags": [
          "api, network"
        ],
        "summary": "Report statistics of a connection between 2 IP addresses",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/LinkReport"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Invalid input"
          }
        }
      }
    },
    "/api/data_app_real/agggregate": {
      "post": {
        "tags": [
          "api, dpi"
        ],
        "summary": "Report statistics of an application",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/AppReport"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Invalid input"
          }
        }
      }
    },
    "/api": {
      "get": {
        "tags": [
          "api, security"
        ],
        "description": "Detect whether an attack occurs based on predefined security rules",
        "parameters": [
          {
            "name": "format",
            "in": "query",
            "description": "Identifier of the format of the encapsulated application report",
            "required": true,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "periodBegin",
            "in": "query",
            "description": "Starting time of analysis",
            "required": true,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "periodEnd",
            "in": "query",
            "description": "End time of analysis",
            "required": true,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "periodNow",
            "in": "query",
            "description": "Current time",
            "required": true,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "periodGroupBy",
            "in": "query",
            "description": "Unit of time, e.g., minute",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "isReload",
            "in": "query",
            "description": "MMT-Operator refreshes periodically its graphical charts",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "boolean"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful operation"
          },
          "400": {
            "description": "Invalid input"
          }
        }
      }
    },
    "/api/security/agggregate": {
      "post": {
        "tags": [
          "api, security"
        ],
        "summary": "Report statistics of a security report",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/SecurityReport"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Invalid input"
          }
        }
      }
    },
    "/api/data_session_real/agggregate": {
      "post": {
        "tags": [
          "api, application"
        ],
        "summary": "Report statistics of a session",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/SessionReport"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Invalid input"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "MacReport": {
        "type": "object",
        "properties": {
          "probeId": {
            "type": "integer",
            "description": "Identifier of a probe",
            "format": "int32"
          },
          "lastSeen": {
            "type": "integer",
            "description": "Timestamp",
            "format": "int64"
          },
          "dataVolume": {
            "type": "integer",
            "description": "Global data volume including headers",
            "format": "int64"
          },
          "packetCount": {
            "type": "integer",
            "description": "Global packet count",
            "format": "int64"
          },
          "upData": {
            "type": "integer",
            "description": "Uplink data volume",
            "format": "int64"
          },
          "upPacket": {
            "type": "integer",
            "description": "Uplink packet count",
            "format": "int64"
          },
          "downData": {
            "type": "integer",
            "description": "Downlink data volume",
            "format": "int64"
          },
          "downPacket": {
            "type": "integer",
            "description": "Downlink packet count",
            "format": "int64"
          },
          "macSource": {
            "type": "string",
            "description": "MAC address source"
          }
        },
        "description": "Data of the last 5 minutes"
      },
      "TotalReport": {
        "type": "object",
        "properties": {
          "formatId": {
            "type": "integer",
            "description": "Identifier of the format of the encapsulated application report",
            "format": "int32"
          },
          "probeId": {
            "type": "integer",
            "description": "Identifier of a probe",
            "format": "int32"
          },
          "sourceId": {
            "type": "integer",
            "description": "Identifier of a source",
            "format": "int32"
          },
          "lastSeen": {
            "type": "integer",
            "description": "Timestamp",
            "format": "int64"
          },
          "reportId": {
            "type": "integer",
            "description": "Identifier of a report",
            "format": "int32"
          },
          "appId": {
            "type": "integer",
            "description": "Identifier of an application",
            "format": "int32"
          },
          "appPath": {
            "type": "string",
            "description": "Application path (e.g., Facebook might have two entries eth.ip.tcp.http.fb and eth.ip.tcp.ssl.fb)"
          },
          "activeFlow": {
            "type": "integer",
            "description": "Number of active flows",
            "format": "int32"
          },
          "dataVolume": {
            "type": "integer",
            "description": "Global data volume including headers",
            "format": "int64"
          },
          "payloadVolume": {
            "type": "integer",
            "description": "Global effective data volume excluding header",
            "format": "int64"
          },
          "packetCount": {
            "type": "integer",
            "description": "Global packet count",
            "format": "int64"
          },
          "upData": {
            "type": "integer",
            "description": "Uplink effective data volume excluding header",
            "format": "int64"
          },
          "upPayload": {
            "type": "integer",
            "description": "Uplink data volume",
            "format": "int64"
          },
          "upPacket": {
            "type": "integer",
            "description": "Uplink packet count",
            "format": "int64"
          },
          "downData": {
            "type": "integer",
            "description": "Downlink data volume",
            "format": "int64"
          },
          "downPayload": {
            "type": "integer",
            "description": "Uplink data volume",
            "format": "int64"
          },
          "downPacket": {
            "type": "integer",
            "description": "Downlink packet count",
            "format": "int64"
          }
        },
        "description": "Latest data"
      },
      "ProtocolReport": {
        "type": "object",
        "properties": {
          "lastSeen": {
            "type": "integer",
            "description": "Timestamp",
            "format": "int64"
          },
          "protocolId": {
            "type": "integer",
            "description": "Identifier of a protocol",
            "format": "int32"
          },
          "protocolPath": {
            "type": "string",
            "description": "Full protocol path (e.g., ETH.IP.TCP.SSL)",
            "example": "99.178.354.341"
          },
          "activeFlow": {
            "type": "integer",
            "description": "Number of active flows",
            "format": "int32"
          },
          "dataVolume": {
            "type": "integer",
            "description": "Global data volume including headers",
            "format": "int64"
          },
          "payloadVolume": {
            "type": "integer",
            "description": "Global effective data volume excluding header",
            "format": "int64"
          },
          "packetCount": {
            "type": "integer",
            "description": "Global packet count",
            "format": "int64"
          }
        },
        "description": "Data of a protocol in the last 5 minutes"
      },
      "IpReport": {
        "type": "object",
        "properties": {
          "probeId": {
            "type": "integer",
            "description": "Identifier of a probe",
            "format": "int32"
          },
          "activeFlow": {
            "type": "integer",
            "description": "Number of active flows",
            "format": "int32"
          },
          "dataVolume": {
            "type": "integer",
            "description": "Global data volume including headers",
            "format": "int64"
          },
          "payloadVolume": {
            "type": "integer",
            "description": "Global effective data volume excluding header",
            "format": "int64"
          },
          "packetCount": {
            "type": "integer",
            "description": "Global packet count",
            "format": "int64"
          },
          "ipSource": {
            "type": "string",
            "description": "IP address source"
          },
          "macSource": {
            "type": "string",
            "description": "MAC address source"
          }
        },
        "description": "Data of an IP"
      },
      "AppReport": {
        "type": "object",
        "properties": {
          "probeId": {
            "type": "integer",
            "description": "Identifier of a probe",
            "format": "int32"
          },
          "lastSeen": {
            "type": "integer",
            "description": "Timestamp",
            "format": "int64"
          },
          "appId": {
            "type": "integer",
            "description": "Identifier of an application",
            "format": "int32"
          },
          "appPath": {
            "type": "string",
            "description": "Application path",
            "example": "99"
          },
          "activeFlow": {
            "type": "integer",
            "description": "Number of active flows",
            "format": "int32"
          },
          "dataVolume": {
            "type": "integer",
            "description": "Global data volume including headers",
            "format": "int64"
          },
          "payloadVolume": {
            "type": "integer",
            "description": "Global effective data volume excluding header",
            "format": "int64"
          },
          "packetCount": {
            "type": "integer",
            "description": "Global packet count",
            "format": "int64"
          }
        },
        "description": "Data of an application"
      },
      "LocationReport": {
        "type": "object",
        "properties": {
          "activeFlow": {
            "type": "integer",
            "description": "Number of active flows",
            "format": "int32"
          },
          "dataVolume": {
            "type": "integer",
            "description": "Global data volume including headers",
            "format": "int64"
          },
          "payloadVolume": {
            "type": "integer",
            "description": "Global effective data volume excluding header",
            "format": "int64"
          },
          "packetCount": {
            "type": "integer",
            "description": "Global packet count",
            "format": "int64"
          },
          "dstLocation": {
            "type": "string",
            "description": "Destination location",
            "example": "United States"
          }
        },
        "description": "Data of a location"
      },
      "LinkReport": {
        "type": "object",
        "properties": {
          "formatId": {
            "type": "integer",
            "description": "Identifier of the format of the encapsulated application report",
            "format": "int32"
          },
          "probeId": {
            "type": "integer",
            "description": "Identifier of a probe",
            "format": "int32"
          },
          "lastSeen": {
            "type": "integer",
            "description": "Timestamp",
            "format": "int64"
          },
          "activeFlow": {
            "type": "integer",
            "description": "Number of active flows",
            "format": "int32"
          },
          "dataVolume": {
            "type": "integer",
            "description": "Global data volume including headers",
            "format": "int64"
          },
          "payloadVolume": {
            "type": "integer",
            "description": "Global effective data volume excluding header",
            "format": "int64"
          },
          "packetCount": {
            "type": "integer",
            "description": "Global packet count",
            "format": "int64"
          },
          "ipSource": {
            "type": "string",
            "description": "IP address source"
          },
          "ipDestination": {
            "type": "string",
            "description": "IP address destination"
          }
        },
        "description": "Data between 2 IP addresses"
      },
      "SecurityReport": {
        "type": "object",
        "properties": {
          "probeId": {
            "type": "integer",
            "description": "Identifier of a probe",
            "format": "int32"
          },
          "lastSeen": {
            "type": "integer",
            "description": "Timestamp",
            "format": "int64"
          },
          "property": {
            "type": "integer",
            "description": "Identifier of a security property",
            "format": "int32"
          },
          "verdict": {
            "type": "string",
            "description": "Status of an attack",
            "enum": [
              "detected",
              "not_detected",
              "respected",
              "not_respected",
              "unknown"
            ]
          },
          "type": {
            "type": "string",
            "description": "Type of an attack",
            "enum": [
              "attack",
              "evasion",
              "security",
              "test"
            ]
          },
          "description": {
            "type": "string",
            "description": "Description of an attack",
            "example": "Probable DoS attack: 4 TCP handshake request in less than 3ms coming from the same IP add"
          },
          "count": {
            "type": "integer",
            "description": "Number of times an attack occurs",
            "format": "int32"
          }
        },
        "description": "Data of a security report"
      },
      "SessionReport": {
        "type": "object",
        "properties": {
          "lastSeen": {
            "type": "integer",
            "description": "Timestamp",
            "format": "int64"
          },
          "activeFlow": {
            "type": "integer",
            "description": "Number of active flows",
            "format": "int32"
          },
          "dataVolume": {
            "type": "integer",
            "description": "Global data volume including headers",
            "format": "int64"
          },
          "payloadVolume": {
            "type": "integer",
            "description": "Global effective data volume excluding header",
            "format": "int64"
          },
          "packetCount": {
            "type": "integer",
            "description": "Global packet count",
            "format": "int64"
          },
          "handshakeTime": {
            "type": "integer",
            "description": "Time for handshake",
            "format": "int64"
          },
          "appResponseTime": {
            "type": "integer",
            "description": "Time for application responses",
            "format": "int64"
          },
          "dataTransferTime": {
            "type": "integer",
            "description": "Time for data transfer",
            "format": "int64"
          },
          "upRetransmission": {
            "type": "integer",
            "description": "Uplink data transmission",
            "format": "int64"
          },
          "downRetransmission": {
            "type": "integer",
            "description": "Downlink data transmission",
            "format": "int64"
          }
        }
      }
    }
  }
}